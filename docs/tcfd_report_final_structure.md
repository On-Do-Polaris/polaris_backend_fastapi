# TCFD ë³´ê³ ì„œ ìµœì¢… êµ¬ì¡° ëª…ì„¸

**ì‘ì„±ì¼**: 2025-12-15
**ë²„ì „**: v2.0 (7-Node Structure)
**ëª©ì **: í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìë¥¼ ìœ„í•œ TCFD ë³´ê³ ì„œ JSON êµ¬ì¡° ì •ì˜

---

## ğŸ“‹ ëª©ì°¨ (Table of Contents)

TCFD ë³´ê³ ì„œëŠ” ì´ **4ê°œ ì„¹ì…˜**ìœ¼ë¡œ êµ¬ì„±ë˜ë©°, ì•½ **18-20 í˜ì´ì§€** ë¶„ëŸ‰ì…ë‹ˆë‹¤.

### 1. Governance (ê±°ë²„ë„ŒìŠ¤) - 3~4 í˜ì´ì§€
```
1. Governance
  1.1 ì´ì‚¬íšŒì˜ ê°ë…
  1.2 ê²½ì˜ì§„ì˜ ì—­í• 
```

### 2. Strategy (ì „ëµ) - 5~11 í˜ì´ì§€
```
2. Strategy
  Executive Summary
  2.1 ë¦¬ìŠ¤í¬ ë° ê¸°íšŒ ì‹ë³„
      - ì‚¬ì—…ì¥ë³„ ë¬¼ë¦¬ì  ë¦¬ìŠ¤í¬ AAL ë¶„í¬ (HeatmapTable)
  2.2 ì‚¬ì—… ë° ì¬ë¬´ ì˜í–¥
  2.3 ì£¼ìš” ë¦¬ìŠ¤í¬ë³„ ì˜í–¥ ë¶„ì„ ë° ëŒ€ì‘ ë°©ì•ˆ
      P1. [ë¦¬ìŠ¤í¬ëª…] ì˜í–¥ ë¶„ì„
      P1. [ë¦¬ìŠ¤í¬ëª…] ëŒ€ì‘ ì „ëµ
      P2. [ë¦¬ìŠ¤í¬ëª…] ì˜í–¥ ë¶„ì„
      P2. [ë¦¬ìŠ¤í¬ëª…] ëŒ€ì‘ ì „ëµ
      P3. [ë¦¬ìŠ¤í¬ëª…] ì˜í–¥ ë¶„ì„
      P3. [ë¦¬ìŠ¤í¬ëª…] ëŒ€ì‘ ì „ëµ
      P4. [ë¦¬ìŠ¤í¬ëª…] ì˜í–¥ ë¶„ì„
      P4. [ë¦¬ìŠ¤í¬ëª…] ëŒ€ì‘ ì „ëµ
      P5. [ë¦¬ìŠ¤í¬ëª…] ì˜í–¥ ë¶„ì„
      P5. [ë¦¬ìŠ¤í¬ëª…] ëŒ€ì‘ ì „ëµ
```

### 3. Risk Management (ë¦¬ìŠ¤í¬ ê´€ë¦¬) - 12~14 í˜ì´ì§€
```
3. Risk Management
  3.1 ë¦¬ìŠ¤í¬ ì‹ë³„ ë° í‰ê°€ í”„ë¡œì„¸ìŠ¤
  3.2 ì „ì‚¬ì  ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì²´ê³„(ERM) í†µí•©
  3.3 ì£¼ìš” ëŒ€ì‘ ì „ëµ
```

### 4. Metrics and Targets (ì§€í‘œ ë° ëª©í‘œ) - 15~18 í˜ì´ì§€
```
4. Metrics and Targets
  4.1 ì£¼ìš” ì§€í‘œ: ì—°í‰ê·  ì†ì‹¤(AAL)
      - ì‹œë‚˜ë¦¬ì˜¤ë³„ í¬íŠ¸í´ë¦¬ì˜¤ AAL ì¶”ì´ ë¹„êµ (Table)
      - í¬íŠ¸í´ë¦¬ì˜¤ AAL ì¶”ì´ (2024-2100) (LineChart)
  4.2 ëª©í‘œ ë° ì´í–‰ ê³„íš
```

### 5. Appendix (ë¶€ë¡) - 19~20 í˜ì´ì§€
```
5. Appendix
  5.1 ìš©ì–´ ì •ì˜
  5.2 ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…
  5.3 ë°©ë²•ë¡  ìƒì„¸
```

---

## ğŸ¨ JSON ë¸”ë¡ íƒ€ì… (5ê°€ì§€)

ë³´ê³ ì„œëŠ” ë‹¤ìŒ 5ê°€ì§€ JSON ë¸”ë¡ íƒ€ì…ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:

| ë¸”ë¡ íƒ€ì… | ìƒì„± ë…¸ë“œ | ê°œìˆ˜ | ì„¤ëª… |
|---------|---------|------|-----|
| `TextBlock` | Node 2-B, 2-C, 3, 5 | ë‹¤ìˆ˜ | ì¼ë°˜ í…ìŠ¤íŠ¸ ì„¹ì…˜ |
| `TableBlock` | Node 2-A | 1ê°œ | ì‹œë‚˜ë¦¬ì˜¤ë³„ AAL ë¹„êµí‘œ |
| `HeatmapTableBlock` | Node 3 | 1ê°œ | ì‚¬ì—…ì¥ë³„ ë¦¬ìŠ¤í¬ ë¶„í¬ íˆíŠ¸ë§µ |
| `LineChartBlock` | Node 5 | 1ê°œ | AAL ì¶”ì´ ì°¨íŠ¸ |
| `BarChartBlock` | (ë¯¸ì‚¬ìš©) | 0ê°œ | í–¥í›„ í™•ì¥ìš© |

---

## ğŸ“¦ ìµœì¢… JSON êµ¬ì¡° (Key ì •ì˜)

### 1ï¸âƒ£ ìµœìƒìœ„ Report ê°ì²´

```json
{
  "report_id": "tcfd_report_20251215_143022",
  "meta": {
    "company_name": "í´ë¼ë¦¬ìŠ¤",
    "report_title": "TCFD ê¸°í›„ ê´€ë ¨ ì¬ë¬´ì •ë³´ ê³µì‹œ ë³´ê³ ì„œ",
    "report_date": "2025-12-15",
    "total_pages": 20,
    "total_sections": 5
  },
  "table_of_contents": [
    {
      "section_id": "governance",
      "title": "1. Governance",
      "page_start": 3,
      "page_end": 4
    },
    {
      "section_id": "strategy",
      "title": "2. Strategy",
      "page_start": 5,
      "page_end": 11
    },
    {
      "section_id": "risk_management",
      "title": "3. Risk Management",
      "page_start": 12,
      "page_end": 14
    },
    {
      "section_id": "metrics_targets",
      "title": "4. Metrics and Targets",
      "page_start": 15,
      "page_end": 18
    },
    {
      "section_id": "appendix",
      "title": "5. Appendix",
      "page_start": 19,
      "page_end": 20
    }
  ],
  "sections": [
    /* Section ê°ì²´ ë°°ì—´ (ì•„ë˜ ì°¸ì¡°) */
  ]
}
```

**Key ì„¤ëª…**:
- `report_id` (string): ë³´ê³ ì„œ ê³ ìœ  ID (íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜)
- `meta` (object): ë³´ê³ ì„œ ë©”íƒ€ë°ì´í„°
- `table_of_contents` (array): ëª©ì°¨ ì •ë³´
- `sections` (array): ì‹¤ì œ ì„¹ì…˜ ë°ì´í„°

---

### 2ï¸âƒ£ Section ê°ì²´

```json
{
  "section_id": "strategy",
  "title": "2. Strategy",
  "page_start": 5,
  "page_end": 11,
  "blocks": [
    /* Block ê°ì²´ ë°°ì—´ (ì•„ë˜ ì°¸ì¡°) */
  ]
}
```

**Key ì„¤ëª…**:
- `section_id` (string): ì„¹ì…˜ ê³ ìœ  ID (`governance`, `strategy`, `risk_management`, `metrics_targets`, `appendix`)
- `title` (string): ì„¹ì…˜ ì œëª©
- `page_start` (integer): ì‹œì‘ í˜ì´ì§€ ë²ˆí˜¸
- `page_end` (integer): ì¢…ë£Œ í˜ì´ì§€ ë²ˆí˜¸
- `blocks` (array): ì„¹ì…˜ ë‚´ ë¸”ë¡ ë°°ì—´

---

### 3ï¸âƒ£ Block ê°ì²´ (5ê°€ì§€ íƒ€ì…)

#### Type 1: TextBlock

```json
{
  "type": "text",
  "subheading": "P1. í•˜ì²œë²”ëŒ ì˜í–¥ ë¶„ì„",
  "content": "**ì¬ë¬´ì  ì˜í–¥**\ní•˜ì²œ ë²”ëŒìœ¼ë¡œ ì¸í•œ ì˜ˆìƒ ì—°í‰ê·  ì†ì‹¤ì•¡ì€..."
}
```

**Key ì„¤ëª…**:
- `type` (string): `"text"` (ê³ ì •ê°’)
- `subheading` (string): ì†Œì œëª©
- `content` (string): ë³¸ë¬¸ (Markdown í˜•ì‹ ì§€ì›)

---

#### Type 2: TableBlock

```json
{
  "type": "table",
  "title": "ì‹œë‚˜ë¦¬ì˜¤ë³„ í¬íŠ¸í´ë¦¬ì˜¤ AAL ì¶”ì´ ë¹„êµ",
  "data": {
    "headers": ["ì‹œë‚˜ë¦¬ì˜¤", "2024", "2030", "2040", "2050", "2100", "ì¦ê°€ìœ¨"],
    "rows": [
      {
        "cells": ["SSP1-2.6 (ì§€ì†ê°€ëŠ¥)", "52.9%", "51.2%", "49.5%", "48.1%", "45.0%", "-14.9%"]
      },
      {
        "cells": ["SSP2-4.5 (ì¤‘ê°„)", "52.9%", "53.8%", "56.2%", "58.9%", "65.3%", "+23.4%"]
      },
      {
        "cells": ["SSP3-7.0 (ì§€ì—­ê²½ìŸ)", "52.9%", "54.5%", "59.1%", "65.2%", "78.1%", "+47.6%"]
      },
      {
        "cells": ["SSP5-8.5 (í™”ì„ì—°ë£Œ)", "52.9%", "55.2%", "61.8%", "70.4%", "89.7%", "+69.6%"]
      }
    ]
  }
}
```

**Key ì„¤ëª…**:
- `type` (string): `"table"` (ê³ ì •ê°’)
- `title` (string): í‘œ ì œëª©
- `data.headers` (array of strings): í—¤ë” í–‰
- `data.rows` (array of objects): ë°ì´í„° í–‰
  - `cells` (array of strings): ê° í–‰ì˜ ì…€ ê°’

---

#### Type 3: HeatmapTableBlock

```json
{
  "type": "heatmap_table",
  "title": "ì‚¬ì—…ì¥ë³„ ë¬¼ë¦¬ì  ë¦¬ìŠ¤í¬ AAL ë¶„í¬",
  "data": {
    "headers": ["ì‚¬ì—…ì¥", "í•˜ì²œë²”ëŒ", "íƒœí’", "ë„ì‹œì¹¨ìˆ˜", "ê·¹ì‹¬í•œê³ ì˜¨", "í•´ìˆ˜ë©´ìƒìŠ¹", "Total AAL"],
    "rows": [
      {
        "site_name": "ì„œìš¸ ë³¸ì‚¬",
        "cells": [
          {
            "value": "5.2%",
            "bg_color": "yellow"
          },
          {
            "value": "12.8%",
            "bg_color": "orange"
          },
          {
            "value": "3.1%",
            "bg_color": "yellow"
          },
          {
            "value": "1.5%",
            "bg_color": "gray"
          },
          {
            "value": "0.2%",
            "bg_color": "gray"
          },
          {
            "value": "22.8%",
            "bg_color": "orange"
          }
        ]
      }
    ],
    "legend": [
      {
        "color": "gray",
        "label": "0-3% (ë‚®ìŒ)"
      },
      {
        "color": "yellow",
        "label": "3-10% (ì¤‘ê°„)"
      },
      {
        "color": "orange",
        "label": "10-30% (ë†’ìŒ)"
      },
      {
        "color": "red",
        "label": "30%+ (ë§¤ìš° ë†’ìŒ)"
      }
    ]
  }
}
```

**Key ì„¤ëª…**:
- `type` (string): `"heatmap_table"` (ê³ ì •ê°’)
- `title` (string): í‘œ ì œëª©
- `data.headers` (array of strings): í—¤ë” í–‰
- `data.rows` (array of objects): ë°ì´í„° í–‰
  - `site_name` (string): ì‚¬ì—…ì¥ ì´ë¦„
  - `cells` (array of objects): ê° ì…€
    - `value` (string): í‘œì‹œ ê°’
    - `bg_color` (string): ë°°ê²½ìƒ‰ (`"gray"`, `"yellow"`, `"orange"`, `"red"`)
- `data.legend` (array of objects): ë²”ë¡€
  - `color` (string): ìƒ‰ìƒ ì½”ë“œ
  - `label` (string): ë²”ë¡€ ë ˆì´ë¸”

---

#### Type 4: LineChartBlock

```json
{
  "type": "line_chart",
  "title": "í¬íŠ¸í´ë¦¬ì˜¤ AAL ì¶”ì´ (2024-2100)",
  "data": {
    "x_axis": {
      "label": "ì—°ë„",
      "categories": [2024, 2030, 2040, 2050, 2100]
    },
    "y_axis": {
      "label": "AAL",
      "min": 0,
      "max": 100,
      "unit": "%"
    },
    "series": [
      {
        "name": "SSP1-2.6",
        "color": "#4CAF50",
        "data": [52.9, 51.2, 49.5, 48.1, 45.0]
      },
      {
        "name": "SSP2-4.5",
        "color": "#FFC107",
        "data": [52.9, 53.8, 56.2, 58.9, 65.3]
      },
      {
        "name": "SSP3-7.0",
        "color": "#FF9800",
        "data": [52.9, 54.5, 59.1, 65.2, 78.1]
      },
      {
        "name": "SSP5-8.5",
        "color": "#F44336",
        "data": [52.9, 55.2, 61.8, 70.4, 89.7]
      }
    ]
  }
}
```

**Key ì„¤ëª…**:
- `type` (string): `"line_chart"` (ê³ ì •ê°’)
- `title` (string): ì°¨íŠ¸ ì œëª©
- `data.x_axis` (object): Xì¶• ì •ë³´
  - `label` (string): Xì¶• ë ˆì´ë¸”
  - `categories` (array): Xì¶• ì¹´í…Œê³ ë¦¬ (ì—°ë„)
- `data.y_axis` (object): Yì¶• ì •ë³´
  - `label` (string): Yì¶• ë ˆì´ë¸”
  - `min` (number): ìµœì†Œê°’
  - `max` (number): ìµœëŒ€ê°’
  - `unit` (string): ë‹¨ìœ„
- `data.series` (array of objects): ë°ì´í„° ì‹œë¦¬ì¦ˆ
  - `name` (string): ì‹œë¦¬ì¦ˆ ì´ë¦„
  - `color` (string): ì„  ìƒ‰ìƒ (HEX ì½”ë“œ)
  - `data` (array of numbers): ë°ì´í„° í¬ì¸íŠ¸

---

#### Type 5: BarChartBlock (í–¥í›„ í™•ì¥ìš©)

```json
{
  "type": "bar_chart",
  "title": "ë¦¬ìŠ¤í¬ë³„ AAL ë¶„í¬",
  "data": {
    "x_axis": {
      "label": "ë¦¬ìŠ¤í¬ ìœ í˜•",
      "categories": ["í•˜ì²œë²”ëŒ", "íƒœí’", "ë„ì‹œì¹¨ìˆ˜", "ê·¹ì‹¬í•œê³ ì˜¨", "í•´ìˆ˜ë©´ìƒìŠ¹"]
    },
    "y_axis": {
      "label": "AAL",
      "min": 0,
      "max": 30,
      "unit": "%"
    },
    "series": [
      {
        "name": "2024",
        "color": "#2196F3",
        "data": [12.5, 18.3, 8.7, 5.2, 3.1]
      },
      {
        "name": "2100",
        "color": "#F44336",
        "data": [18.9, 28.5, 15.2, 12.8, 8.9]
      }
    ]
  }
}
```

**Key ì„¤ëª…**:
- `type` (string): `"bar_chart"` (ê³ ì •ê°’)
- ë‚˜ë¨¸ì§€ êµ¬ì¡°ëŠ” LineChartBlockê³¼ ë™ì¼

---

## ğŸ”„ ë°ì´í„° íë¦„ ìš”ì•½

```
Node 0 (Data Loading)
  â†“
Node 1 (Template Loading)
  â†“
Node 2-A (Scenario Analysis) â†’ TableBlock ìƒì„±
  â†“
Node 2-B (Impact Analysis) â†’ TextBlock x5 ìƒì„± (P1~P5 ì˜í–¥)
  â†“
Node 2-C (Mitigation Strategies) â†’ TextBlock x5 ìƒì„± (P1~P5 ëŒ€ì‘)
  â†“
Node 3 (Strategy Section) â†’ HeatmapTableBlock ìƒì„± + ë¸”ë¡ ì¡°ë¦½
  â†“
Node 4 (Validator) â†’ ê²€ì¦
  â†“
Node 5 (Composer) â†’ LineChartBlock ìƒì„± + ì „ì²´ ì¡°ë¦½
  â†“
Node 6 (Finalizer) â†’ ìµœì¢… ë³´ê³ ì„œ JSON ë°˜í™˜
```

---

## ğŸ“Œ í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„ ê°€ì´ë“œ

### 1. JSON íŒŒì‹± ìˆœì„œ
1. `report.meta`ë¥¼ ì½ì–´ ë³´ê³ ì„œ ì œëª© ë° í˜ì´ì§€ ìˆ˜ í‘œì‹œ
2. `report.table_of_contents`ë¥¼ ì½ì–´ ëª©ì°¨ ë Œë”ë§
3. `report.sections` ë°°ì—´ì„ ìˆœíšŒí•˜ë©° ê° ì„¹ì…˜ ë Œë”ë§
4. ê° ì„¹ì…˜ì˜ `blocks` ë°°ì—´ì„ ìˆœíšŒí•˜ë©° `type` í•„ë“œì— ë”°ë¼ ì ì ˆí•œ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§

### 2. Block ë Œë”ë§ ë§¤í•‘
```javascript
switch (block.type) {
  case 'text':
    return <TextBlock data={block} />
  case 'table':
    return <TableBlock data={block} />
  case 'heatmap_table':
    return <HeatmapTableBlock data={block} />
  case 'line_chart':
    return <LineChartBlock data={block} />
  case 'bar_chart':
    return <BarChartBlock data={block} />
  default:
    return null
}
```

### 3. ìƒ‰ìƒ ì½”ë“œ (HeatmapTable)
```css
.bg-gray { background-color: #E0E0E0; }   /* 0-3% (ë‚®ìŒ) */
.bg-yellow { background-color: #FFF59D; } /* 3-10% (ì¤‘ê°„) */
.bg-orange { background-color: #FFCC80; } /* 10-30% (ë†’ìŒ) */
.bg-red { background-color: #EF9A9A; }    /* 30%+ (ë§¤ìš° ë†’ìŒ) */
```

### 4. ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê¶Œì¥
- **LineChart / BarChart**: Chart.js, Recharts, ApexCharts
- **HeatmapTable**: ì»¤ìŠ¤í…€ CSS Grid ë˜ëŠ” Material-UI Table

---

## ğŸš€ API ì‘ë‹µ ì˜ˆì‹œ

### Request
```
POST /api/tcfd-report/generate
{
  "site_ids": [1, 2, 3, 4, 5, 6, 7, 8],
  "excel_file": "optional_additional_data.xlsx",
  "user_id": 123
}
```

### Response
```json
{
  "status": "success",
  "report": {
    "report_id": "tcfd_report_20251215_143022",
    "meta": { ... },
    "table_of_contents": [ ... ],
    "sections": [ ... ]
  }
}
```

---

## âœ… Key ê°’ ì²´í¬ë¦¬ìŠ¤íŠ¸

í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ ì‹œ ë‹¤ìŒ key ê°’ë“¤ì´ **ê³ ì •**ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì•ˆì „í•˜ê²Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤:

### Report ë ˆë²¨
- âœ… `report_id` (string)
- âœ… `meta` (object)
  - âœ… `company_name` (string)
  - âœ… `report_title` (string)
  - âœ… `report_date` (string)
  - âœ… `total_pages` (integer)
  - âœ… `total_sections` (integer)
- âœ… `table_of_contents` (array)
- âœ… `sections` (array)

### Section ë ˆë²¨
- âœ… `section_id` (string): `"governance"`, `"strategy"`, `"risk_management"`, `"metrics_targets"`, `"appendix"`
- âœ… `title` (string)
- âœ… `page_start` (integer)
- âœ… `page_end` (integer)
- âœ… `blocks` (array)

### Block ë ˆë²¨ (ê³µí†µ)
- âœ… `type` (string): `"text"`, `"table"`, `"heatmap_table"`, `"line_chart"`, `"bar_chart"`

### TextBlock
- âœ… `subheading` (string)
- âœ… `content` (string)

### TableBlock
- âœ… `title` (string)
- âœ… `data.headers` (array of strings)
- âœ… `data.rows` (array of objects)
  - âœ… `cells` (array of strings)

### HeatmapTableBlock
- âœ… `title` (string)
- âœ… `data.headers` (array of strings)
- âœ… `data.rows` (array of objects)
  - âœ… `site_name` (string)
  - âœ… `cells` (array of objects)
    - âœ… `value` (string)
    - âœ… `bg_color` (string): `"gray"`, `"yellow"`, `"orange"`, `"red"`
- âœ… `data.legend` (array of objects)
  - âœ… `color` (string)
  - âœ… `label` (string)

### LineChartBlock & BarChartBlock
- âœ… `title` (string)
- âœ… `data.x_axis` (object)
  - âœ… `label` (string)
  - âœ… `categories` (array)
- âœ… `data.y_axis` (object)
  - âœ… `label` (string)
  - âœ… `min` (number)
  - âœ… `max` (number)
  - âœ… `unit` (string)
- âœ… `data.series` (array of objects)
  - âœ… `name` (string)
  - âœ… `color` (string)
  - âœ… `data` (array of numbers)

---

## ğŸ“ ë¬¸ì˜

- **ë°±ì—”ë“œ ë‹´ë‹¹**: AI Agent íŒ€
- **ìŠ¤í‚¤ë§ˆ ì •ì˜**: `polaris_backend_fastapi/ai_agent/agents/tcfd_report/schemas.py`
- **ì—…ë°ì´íŠ¸ ì´ë ¥**: `polaris_backend_fastapi/docs/progress/tcfd_report_refactoring_progress.md`
