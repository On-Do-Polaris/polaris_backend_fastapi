<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ModelOps Site Assessment API í…ŒìŠ¤íŠ¸ ì½˜ì†”</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #06b6d4;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem;
            color: var(--gray-900);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo {
            font-size: 1.75rem;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        @media (max-width: 1024px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid var(--gray-100);
        }

        .card-title {
            font-size: 1.35rem;
            font-weight: 700;
            color: var(--gray-900);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .badge {
            display: inline-block;
            padding: 0.35rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge.primary { background: #dbeafe; color: #1e40af; }
        .badge.success { background: #d1fae5; color: #065f46; }
        .badge.danger { background: #fee2e2; color: #991b1b; }
        .badge.warning { background: #fef3c7; color: #92400e; }
        .badge.info { background: #cffafe; color: #164e63; }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--gray-700);
            font-size: 0.9rem;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 0.65rem;
            border: 2px solid var(--gray-200);
            border-radius: 8px;
            font-size: 0.9rem;
            transition: all 0.2s;
            font-family: inherit;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-family: inherit;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover:not(:disabled) {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover:not(:disabled) {
            background: #dc2626;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
        }

        .btn-info {
            background: var(--info);
            color: white;
        }

        .btn-info:hover:not(:disabled) {
            background: #0891b2;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(6, 182, 212, 0.4);
        }

        .btn-block {
            width: 100%;
        }

        .loading {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .alert {
            padding: 1rem 1.25rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            border-left: 4px solid;
            font-size: 0.9rem;
        }

        .alert-success {
            background: #d1fae5;
            color: #065f46;
            border-color: var(--success);
        }

        .alert-error {
            background: #fee2e2;
            color: #991b1b;
            border-color: var(--danger);
        }

        .alert-info {
            background: #dbeafe;
            color: #1e40af;
            border-color: var(--primary);
        }

        .alert-warning {
            background: #fef3c7;
            color: #92400e;
            border-color: var(--warning);
        }

        .result-box {
            background: var(--gray-50);
            border: 2px solid var(--gray-200);
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 1rem;
            max-height: 500px;
            overflow-y: auto;
        }

        .result-box pre {
            margin: 0;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .status-indicator.online {
            background: #d1fae5;
            color: #065f46;
        }

        .status-indicator.offline {
            background: #fee2e2;
            color: #991b1b;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-dot.online {
            background: #10b981;
        }

        .status-dot.offline {
            background: #ef4444;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .risk-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
            padding: 1rem;
            background: var(--gray-50);
            border-radius: 10px;
        }

        .risk-item {
            text-align: center;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            border: 2px solid var(--gray-200);
        }

        .risk-name {
            font-size: 0.75rem;
            color: var(--gray-600);
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .risk-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .section-divider {
            margin: 1.5rem 0;
            border: 0;
            border-top: 2px dashed var(--gray-200);
        }

        .quick-test-buttons {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .collapsible {
            cursor: pointer;
            user-select: none;
        }

        .collapsible:hover {
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">ğŸ¢ ModelOps Site Assessment API í…ŒìŠ¤íŠ¸</div>
                <div id="healthStatus"></div>
            </div>
        </div>

        <div class="grid">
            <!-- Health Check -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        ğŸ¥ Health Check
                        <span class="badge primary">GET</span>
                    </h2>
                </div>
                <div class="quick-test-buttons">
                    <button class="btn btn-success" onclick="checkHealth()">
                        âœ“ Health
                    </button>
                    <button class="btn btn-info" onclick="checkDatabaseHealth()">
                        ğŸ—„ï¸ Database
                    </button>
                </div>
                <div id="healthResult" class="result-box" style="display: none;"></div>
            </div>

            <!-- Site Risk Calculation -->
            <div class="card full-width">
                <div class="card-header">
                    <h2 class="card-title">
                        ğŸ¯ ì‚¬ì—…ì¥ ë¦¬ìŠ¤í¬ ê³„ì‚°
                        <span class="badge success">POST</span>
                    </h2>
                </div>
                <form onsubmit="event.preventDefault(); calculateSiteRisk();">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ìœ„ë„ (Latitude) *</label>
                            <input type="number" id="siteLatitude" class="form-input" step="0.000001" value="37.5665" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ê²½ë„ (Longitude) *</label>
                            <input type="number" id="siteLongitude" class="form-input" step="0.000001" value="126.9780" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Site ID (ì„ íƒ)</label>
                        <input type="text" id="siteId" class="form-input" placeholder="SITE-2025-001">
                    </div>

                    <hr class="section-divider">
                    <h3 style="margin-bottom: 1rem; font-size: 1.1rem; color: var(--gray-700);">ğŸ“‹ ê±´ë¬¼ ì •ë³´ (í•„ìˆ˜)</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ê±´ë¬¼ ìœ í˜• *</label>
                            <select id="buildingType" class="form-select" required>
                                <option value="office">ì‚¬ë¬´ì‹¤ (Office)</option>
                                <option value="factory">ê³µì¥ (Factory)</option>
                                <option value="warehouse">ì°½ê³  (Warehouse)</option>
                                <option value="residential">ì£¼ê±° (Residential)</option>
                                <option value="commercial">ìƒì—… (Commercial)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">êµ¬ì¡° *</label>
                            <select id="structure" class="form-select" required>
                                <option value="ì² ê·¼ì½˜í¬ë¦¬íŠ¸">ì² ê·¼ì½˜í¬ë¦¬íŠ¸</option>
                                <option value="ì² ê³¨">ì² ê³¨</option>
                                <option value="ëª©ì¡°">ëª©ì¡°</option>
                                <option value="ì¡°ì ">ì¡°ì </option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ê±´ë¬¼ ì—°ì‹ (ë…„) *</label>
                            <input type="number" id="buildingAge" class="form-input" value="15" min="0" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì „ì²´ ë©´ì  (mÂ²) *</label>
                            <input type="number" id="totalArea" class="form-input" value="2500" min="0" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ì§€ìƒ ì¸µìˆ˜ *</label>
                            <input type="number" id="groundFloors" class="form-input" value="5" min="0" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì§€í•˜ ì¸µìˆ˜ *</label>
                            <input type="number" id="basementFloors" class="form-input" value="1" min="0" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">í•„ë¡œí‹° êµ¬ì¡° ì—¬ë¶€</label>
                            <select id="hasPiloti" class="form-select">
                                <option value="false">ì—†ìŒ</option>
                                <option value="true">ìˆìŒ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ì§€ë©´ ê³ ë„ (m)</label>
                            <input type="number" id="elevation" class="form-input" value="10" step="0.1">
                        </div>
                    </div>

                    <hr class="section-divider">
                    <h3 style="margin-bottom: 1rem; font-size: 1.1rem; color: var(--gray-700);">ğŸ’° ìì‚° ì •ë³´ (ì„ íƒ)</h3>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ì´ ìì‚° ê°€ì¹˜ (ì›)</label>
                            <input type="number" id="totalValue" class="form-input" value="50000000000" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ë³´í—˜ ì»¤ë²„ë¦¬ì§€ ë¹„ìœ¨ (0~1)</label>
                            <input type="number" id="insuranceRate" class="form-input" value="0.3" step="0.1" min="0" max="1">
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-block" id="siteCalcButton">
                        ğŸš€ ë¦¬ìŠ¤í¬ ê³„ì‚° ì‹œì‘
                    </button>
                </form>
                <div id="siteCalcResult"></div>
            </div>

            <!-- Relocation Recommendation -->
            <div class="card full-width">
                <div class="card-header">
                    <h2 class="card-title">
                        ğŸ“ ì´ì „ í›„ë³´ì§€ ì¶”ì²œ
                        <span class="badge warning">POST</span>
                    </h2>
                </div>
                <div class="alert alert-info">
                    ì´ ê¸°ëŠ¥ì€ ì—¬ëŸ¬ í›„ë³´ì§€ ê²©ìë¥¼ í‰ê°€í•˜ì—¬ ìµœì ì˜ ì´ì „ ìœ„ì¹˜ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤. (ì‹œê°„ì´ ë‹¤ì†Œ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤)
                </div>
                <form onsubmit="event.preventDefault(); recommendLocations();">
                    <div class="form-group">
                        <label class="form-label">í›„ë³´ì§€ ê²©ì (JSON ë°°ì—´) *</label>
                        <textarea id="candidateGrids" class="form-input" rows="5" required>[
  {"latitude": 37.5665, "longitude": 126.9780},
  {"latitude": 37.5666, "longitude": 126.9781},
  {"latitude": 37.5667, "longitude": 126.9782}
]</textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ìµœëŒ€ ì¶”ì²œ ê°œìˆ˜</label>
                            <input type="number" id="maxCandidates" class="form-input" value="3" min="1" max="10">
                        </div>
                        <div class="form-group">
                            <label class="form-label">SSP ì‹œë‚˜ë¦¬ì˜¤</label>
                            <select id="sspScenario" class="form-select">
                                <option value="ssp2">SSP2</option>
                                <option value="ssp5">SSP5</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ëª©í‘œ ì—°ë„</label>
                        <input type="number" id="targetYear" class="form-input" value="2040" min="2020" max="2100">
                    </div>

                    <div class="alert alert-warning">
                        âš ï¸ ê±´ë¬¼ ì •ë³´ì™€ ìì‚° ì •ë³´ëŠ” ìœ„ì˜ "ì‚¬ì—…ì¥ ë¦¬ìŠ¤í¬ ê³„ì‚°" ì„¹ì…˜ì—ì„œ ì…ë ¥í•œ ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
                    </div>

                    <button type="submit" class="btn btn-danger btn-block" id="recommendButton">
                        ğŸ” í›„ë³´ì§€ ì¶”ì²œ ì‹œì‘
                    </button>
                </form>
                <div id="recommendResult"></div>
            </div>
        </div>
    </div>

    <script>
        let baseURL = '/modelops-proxy';

        // Auto health check on load
        window.addEventListener('load', () => {
            checkHealth();
        });

        // Utility: Format JSON
        function formatJSON(obj) {
            return JSON.stringify(obj, null, 2);
        }

        // Utility: Show result
        function showResult(elementId, data, type = 'success') {
            const element = document.getElementById(elementId);
            const alertClass = type === 'error' ? 'alert-error' :
                              type === 'warning' ? 'alert-warning' :
                              type === 'info' ? 'alert-info' : 'alert-success';

            let html = '';
            if (typeof data === 'string') {
                html = `<div class="alert ${alertClass}">${data}</div>`;
            } else {
                html = `<div class="result-box"><pre>${formatJSON(data)}</pre></div>`;
            }

            element.innerHTML = html;
            element.style.display = 'block';
        }

        // Get Building Info
        function getBuildingInfo() {
            return {
                building_type: document.getElementById('buildingType').value,
                structure: document.getElementById('structure').value,
                building_age: parseInt(document.getElementById('buildingAge').value),
                total_area_m2: parseFloat(document.getElementById('totalArea').value),
                ground_floors: parseInt(document.getElementById('groundFloors').value),
                basement_floors: parseInt(document.getElementById('basementFloors').value),
                has_piloti: document.getElementById('hasPiloti').value === 'true',
                elevation_m: parseFloat(document.getElementById('elevation').value)
            };
        }

        // Get Asset Info
        function getAssetInfo() {
            const totalValue = document.getElementById('totalValue').value;
            const insuranceRate = document.getElementById('insuranceRate').value;

            if (!totalValue) return null;

            return {
                total_value: parseFloat(totalValue),
                insurance_coverage_rate: parseFloat(insuranceRate)
            };
        }

        // Health Check
        async function checkHealth() {
            const statusDiv = document.getElementById('healthStatus');
            statusDiv.innerHTML = '<div class="status-indicator offline"><div class="status-dot offline"></div>í™•ì¸ ì¤‘...</div>';

            try {
                const response = await fetch(`${baseURL}/health`);
                const data = await response.json();

                statusDiv.innerHTML = '<div class="status-indicator online"><div class="status-dot online"></div>ì˜¨ë¼ì¸</div>';
                showResult('healthResult', data, 'success');
            } catch (error) {
                statusDiv.innerHTML = '<div class="status-indicator offline"><div class="status-dot offline"></div>ì˜¤í”„ë¼ì¸</div>';
                showResult('healthResult', `ì—°ê²° ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        async function checkDatabaseHealth() {
            try {
                const response = await fetch(`${baseURL}/health/db`);
                const data = await response.json();
                showResult('healthResult', data, 'success');
            } catch (error) {
                showResult('healthResult', `Database ì—°ê²° ì‹¤íŒ¨: ${error.message}`, 'error');
            }
        }

        // Calculate Site Risk
        async function calculateSiteRisk() {
            const button = document.getElementById('siteCalcButton');
            button.disabled = true;
            button.innerHTML = '<div class="loading"></div> ê³„ì‚° ì¤‘...';

            const latitude = parseFloat(document.getElementById('siteLatitude').value);
            const longitude = parseFloat(document.getElementById('siteLongitude').value);
            const siteId = document.getElementById('siteId').value;

            const payload = {
                latitude,
                longitude,
                building_info: getBuildingInfo()
            };

            if (siteId) {
                payload.site_id = siteId;
            }

            const assetInfo = getAssetInfo();
            if (assetInfo) {
                payload.asset_info = assetInfo;
            }

            try {
                const response = await fetch(`${baseURL}/api/v1/site-assessment/calculate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                const data = await response.json();

                if (response.ok) {
                    // Display summary
                    const summary = data.summary || {};
                    const summaryHTML = `
                        <div class="alert alert-success">
                            âœ… ë¦¬ìŠ¤í¬ ê³„ì‚° ì™„ë£Œ!
                        </div>
                        <div class="risk-summary">
                            <div class="risk-item">
                                <div class="risk-name">ì´ í†µí•© ë¦¬ìŠ¤í¬</div>
                                <div class="risk-value">${summary.total_integrated_risk?.toFixed(2) || 'N/A'}</div>
                            </div>
                            <div class="risk-item">
                                <div class="risk-name">ì´ AAL</div>
                                <div class="risk-value">${summary.total_final_aal?.toFixed(6) || 'N/A'}</div>
                            </div>
                            <div class="risk-item">
                                <div class="risk-name">í‰ê°€ ë¦¬ìŠ¤í¬ ìˆ˜</div>
                                <div class="risk-value">${summary.risk_count || 'N/A'}</div>
                            </div>
                        </div>
                    `;

                    document.getElementById('siteCalcResult').innerHTML = summaryHTML;
                    showResult('siteCalcResult', data, 'success');
                } else {
                    showResult('siteCalcResult', data, 'error');
                }
            } catch (error) {
                showResult('siteCalcResult', `ìš”ì²­ ì‹¤íŒ¨: ${error.message}`, 'error');
            } finally {
                button.disabled = false;
                button.innerHTML = 'ğŸš€ ë¦¬ìŠ¤í¬ ê³„ì‚° ì‹œì‘';
            }
        }

        // Recommend Relocation Locations
        async function recommendLocations() {
            const button = document.getElementById('recommendButton');
            button.disabled = true;
            button.innerHTML = '<div class="loading"></div> ì¶”ì²œ ì¤‘... (ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤)';

            try {
                // Parse candidate grids
                const candidateGridsText = document.getElementById('candidateGrids').value;
                const candidateGrids = JSON.parse(candidateGridsText);

                const payload = {
                    candidate_grids: candidateGrids,
                    building_info: getBuildingInfo(),
                    search_criteria: {
                        max_candidates: parseInt(document.getElementById('maxCandidates').value),
                        ssp_scenario: document.getElementById('sspScenario').value,
                        target_year: parseInt(document.getElementById('targetYear').value)
                    }
                };

                const assetInfo = getAssetInfo();
                if (assetInfo) {
                    payload.asset_info = assetInfo;
                }

                const response = await fetch(`${baseURL}/api/v1/site-assessment/recommend-locations`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                const data = await response.json();

                if (response.ok) {
                    // Display candidates
                    const candidates = data.candidates || [];
                    const candidatesHTML = `
                        <div class="alert alert-success">
                            âœ… í›„ë³´ì§€ ì¶”ì²œ ì™„ë£Œ! (ì´ ${data.total_grids_evaluated}ê°œ ê²©ì í‰ê°€)
                        </div>
                        ${candidates.map(candidate => `
                            <div style="margin-top: 1rem; padding: 1rem; background: var(--gray-50); border-radius: 10px; border-left: 4px solid var(--primary);">
                                <h4 style="margin-bottom: 0.5rem; color: var(--primary);">
                                    ğŸ† ìˆœìœ„ ${candidate.rank} - (${candidate.latitude.toFixed(4)}, ${candidate.longitude.toFixed(4)})
                                </h4>
                                <div class="risk-summary">
                                    <div class="risk-item">
                                        <div class="risk-name">ì´ AAL</div>
                                        <div class="risk-value">${candidate.total_aal.toFixed(6)}</div>
                                    </div>
                                    <div class="risk-item">
                                        <div class="risk-name">í‰ê·  í†µí•© ë¦¬ìŠ¤í¬</div>
                                        <div class="risk-value">${candidate.average_integrated_risk.toFixed(2)}</div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    `;

                    document.getElementById('recommendResult').innerHTML = candidatesHTML;
                    showResult('recommendResult', data, 'success');
                } else {
                    showResult('recommendResult', data, 'error');
                }
            } catch (error) {
                if (error instanceof SyntaxError) {
                    showResult('recommendResult', `JSON íŒŒì‹± ì‹¤íŒ¨: í›„ë³´ì§€ ê²©ì í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”`, 'error');
                } else {
                    showResult('recommendResult', `ìš”ì²­ ì‹¤íŒ¨: ${error.message}`, 'error');
                }
            } finally {
                button.disabled = false;
                button.innerHTML = 'ğŸ” í›„ë³´ì§€ ì¶”ì²œ ì‹œì‘';
            }
        }
    </script>
</body>
</html>
